(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(e){if(e.ep)return;e.ep=!0;const a=s(e);fetch(e.href,a)}})();const B={};B.show=function(){if(!B.el){const t=document.querySelector(".popup-wrapper"),o=document.querySelector(".popup-wrapper__body"),s=t.querySelector("button.modify"),n=t.querySelector("button.delete"),e=t.querySelector("button.copy");t.addEventListener("click",function(){B.hide()}),s.onclick=function(a){a.preventDefault();const r=this.parentElement.previousElementSibling.value,u=Number(this.parentElement.previousElementSibling.dataset.index);tasks.splice(u,1,JSON.parse(r)),syncLocal(),B.hide(),redrawChart(!0)},n.onclick=function(a){a.preventDefault();const r=Number(this.parentElement.previousElementSibling.dataset.index);confirm("Are you sure to DELETE the task?")&&(tasks.splice(r,1),syncLocal()),B.hide(),redrawChart(!0)},e.onclick=function(a){a.preventDefault();const r=Number(this.parentElement.previousElementSibling.dataset.index),u={...tasks[r],duration:1};tasks.splice(r+1,0,u),console.log(tasks[r]),syncLocal(),B.hide(),redrawChart(!0)},o.onclick=function(a){a.stopPropagation()},B.el=t}B.el.style.display="flex"};B.hide=function(){B.el.style.display="none"};function ht(t,o,s){if(t&&t.length){const[n,e]=o,a=Math.PI/180*s,r=Math.cos(a),u=Math.sin(a);for(const p of t){const[i,l]=p;p[0]=(i-n)*r-(l-e)*u+n,p[1]=(i-n)*u+(l-e)*r+e}}}function Ht(t,o,s){const n=[];t.forEach(e=>n.push(...e)),ht(n,o,s)}function Dt(t,o){return t[0]===o[0]&&t[1]===o[1]}function St(t,o,s,n=1){const e=s,a=Math.max(o,.1),r=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,u=[0,0];if(e)for(const i of r)ht(i,u,e);const p=$t(r,a,n);if(e){for(const i of r)ht(i,u,-e);Ht(p,u,-e)}return p}function $t(t,o,s){const n=[];for(const i of t){const l=[...i];Dt(l[0],l[l.length-1])||l.push([l[0][0],l[0][1]]),l.length>2&&n.push(l)}const e=[];o=Math.max(o,.1);const a=[];for(const i of n)for(let l=0;l<i.length-1;l++){const h=i[l],S=i[l+1];if(h[1]!==S[1]){const H=Math.min(h[1],S[1]);a.push({ymin:H,ymax:Math.max(h[1],S[1]),x:H===h[1]?h[0]:S[0],islope:(S[0]-h[0])/(S[1]-h[1])})}}if(a.sort((i,l)=>i.ymin<l.ymin?-1:i.ymin>l.ymin?1:i.x<l.x?-1:i.x>l.x?1:i.ymax===l.ymax?0:(i.ymax-l.ymax)/Math.abs(i.ymax-l.ymax)),!a.length)return e;let r=[],u=a[0].ymin,p=0;for(;r.length||a.length;){if(a.length){let i=-1;for(let h=0;h<a.length&&!(a[h].ymin>u);h++)i=h;a.splice(0,i+1).forEach(h=>{r.push({s:u,edge:h})})}if(r=r.filter(i=>!(i.edge.ymax<=u)),r.sort((i,l)=>i.edge.x===l.edge.x?0:(i.edge.x-l.edge.x)/Math.abs(i.edge.x-l.edge.x)),(s!==1||p%o===0)&&r.length>1)for(let i=0;i<r.length;i=i+2){const l=i+1;if(l>=r.length)break;const h=r[i].edge,S=r[l].edge;e.push([[Math.round(h.x),u],[Math.round(S.x),u]])}u+=s,r.forEach(i=>{i.edge.x=i.edge.x+s*i.edge.islope}),p++}return e}window.hachureLines=St;const pt={"01-01":{holiday:!0,name:"元旦",wage:3,date:"2024-01-01",rest:1},"02-04":{holiday:!1,name:"春节前补班",wage:1,after:!1,target:"春节",date:"2024-02-04",rest:34},"02-10":{holiday:!0,name:"初一",wage:3,date:"2024-02-10",rest:40},"02-11":{holiday:!0,name:"初二",wage:3,date:"2024-02-11"},"02-12":{holiday:!0,name:"初三",wage:3,date:"2024-02-12"},"02-13":{holiday:!0,name:"初四",wage:2,date:"2024-02-13"},"02-14":{holiday:!0,name:"初五",wage:2,date:"2024-02-14"},"02-15":{holiday:!0,name:"初六",wage:2,date:"2024-02-15"},"02-16":{holiday:!0,name:"初七",wage:2,date:"2024-02-16"},"02-17":{holiday:!0,name:"初八",wage:2,date:"2024-02-17"},"02-18":{holiday:!1,name:"春节后补班",wage:1,after:!0,target:"春节",date:"2024-02-18"},"04-04":{holiday:!0,name:"清明节",wage:3,date:"2024-04-04",rest:46},"04-05":{holiday:!0,name:"清明节",wage:2,date:"2024-04-05"},"04-06":{holiday:!0,name:"清明节",wage:2,date:"2024-04-06"},"04-07":{holiday:!1,name:"清明节后补班",wage:1,target:"清明节",after:!0,date:"2024-04-07"},"04-28":{holiday:!1,name:"劳动节前补班",wage:1,target:"劳动节",after:!1,date:"2024-04-28"},"05-01":{holiday:!0,name:"劳动节",wage:3,date:"2024-05-01"},"05-02":{holiday:!0,name:"劳动节",wage:2,date:"2024-05-02"},"05-03":{holiday:!0,name:"劳动节",wage:3,date:"2024-05-03"},"05-04":{holiday:!0,name:"劳动节",wage:3,date:"2024-05-04"},"05-05":{holiday:!0,name:"劳动节",wage:3,date:"2024-05-05"},"05-11":{holiday:!1,name:"劳动节后补班",after:!0,wage:1,target:"劳动节",date:"2024-05-11"},"06-08":{holiday:!0,name:"端午节",wage:2,date:"2024-06-08"},"06-09":{holiday:!0,name:"端午节",wage:2,date:"2024-06-09"},"06-10":{holiday:!0,name:"端午节",wage:3,date:"2024-06-10"},"09-14":{holiday:!1,name:"中秋节前补班",after:!1,wage:1,target:"中秋节",date:"2024-09-14"},"09-15":{holiday:!0,name:"中秋节",wage:2,date:"2024-09-15"},"09-16":{holiday:!0,name:"中秋节",wage:2,date:"2024-09-16"},"09-17":{holiday:!0,name:"中秋节",wage:3,date:"2024-09-17"},"09-29":{holiday:!1,name:"国庆节前补班",after:!1,wage:1,target:"国庆节",date:"2024-09-29"},"10-01":{holiday:!0,name:"国庆节",wage:3,date:"2024-10-01"},"10-02":{holiday:!0,name:"国庆节",wage:3,date:"2024-10-02",rest:1},"10-03":{holiday:!0,name:"国庆节",wage:3,date:"2024-10-03"},"10-04":{holiday:!0,name:"国庆节",wage:2,date:"2024-10-04"},"10-05":{holiday:!0,name:"国庆节",wage:2,date:"2024-10-05"},"10-06":{holiday:!0,name:"国庆节",wage:2,date:"2024-10-06",rest:1},"10-07":{holiday:!0,name:"国庆节",wage:2,date:"2024-10-07",rest:1},"10-12":{holiday:!1,after:!0,wage:1,name:"国庆节后补班",target:"国庆节",date:"2024-10-12"}};function vt(t){const o=new Date(t),s=o.getMonth()+1+"",n=s.padStart(2,"0"),e=o.getDate()+"",a=e.padStart(2,"0"),r=`${n}-${a}`,u=[0,6].indexOf(o.getDay())!=-1;return pt[r]?{isHoliday:pt[r].holiday,dateString:`${s}-${e}`}:{isHoliday:u,dateString:`${s}-${e}`}}function k(t="unitWidth",o=!0){const s=new URLSearchParams(location.search);return s.get(t)&&o?Number(s.get(t)):s.get(t)}function $(){Z||Pt()||k("useLocal")&&Object.keys(it).forEach(t=>{const o=localStorage.getItem(t);try{localStorage.setItem(t,JSON.stringify(window[t]))}catch{console.error("fail to syncLocal"),localStorage.setItem(t,o)}})}window.syncLocal=$;let dt=null;function Pt(){if(k("useRemote")){const t={tasks:window.tasks,mileStones:window.mileStones};return dt&&clearTimeout(dt),dt=setTimeout(()=>{kt(t).then(o=>{o.status===0&&console.log("recordUpdate成功",o)})},200),!0}return!1}const zt=localStorage.getItem("remoteHost")?localStorage.getItem("remoteHost"):"http://localhost:3004";function kt(t){return fetch(`${zt}/record/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({view:st,...t})}).then(o=>o.json())}function Nt(){return console.log("current view",st),fetch(`${zt}/record/query${st?`?view=${st}`:""}`).then(t=>t.json())}const it={tasks:[{}],mileStones:[]};function Lt(t="tasks"){try{return localStorage.getItem(t)?JSON.parse(localStorage.getItem(t)):it[t]}catch{return console.error("fail to getLocal"),it[t]}}function j(){const t=Math.floor(Math.random()*256),o=Math.floor(Math.random()*256),s=Math.floor(Math.random()*256);return"#"+t.toString(16).padStart(2,"0")+o.toString(16).padStart(2,"0")+s.toString(16).padStart(2,"0")}function It(t,o){t.dom.style.opacity=0,Nt().then(s=>{const{data:n}=s;console.log(n),n!=null&&n.tasks||n!=null&&n.mileStones?(ft("tasks",n.tasks.filter(e=>Z?e.fillColor===Z:!0)),ft("mileStones",n.mileStones)):n||window.tasks.push({}),bt(n==null?void 0:n.tasks),o(!0),t.dom.style.opacity=1})}function Ot(t){const o=t?{view:`${t}`}:{};kt({tasks:window.tasks,mileStones:window.mileStones,...o})}window.saveToRemote=Ot;function qt(t){Object.keys(it).forEach(o=>{const s=localStorage.getItem(o);try{localStorage.setItem(o,JSON.stringify(window[o]))}catch{console.error("fail to syncLocal"),localStorage.setItem(o,s)}})}window.saveToLocal=qt;function ft(t,o){window[`old_${t}`]=[...window[t]],window[t].length=0,window[t].push(...o)}function xt(t){var s;console.log(t.target);const o=new URLSearchParams(location.search);(s=t.target.dataset)!=null&&s.color?(t.target.dataset.hovered=!0,o.set("filter",t.target.dataset.color)):o.delete("filter"),location.href="/?"+o.toString()}function bt(t){if(!Et||!t)return;const o=t,s=document.querySelector("#color-picker");console.log("123"),s.removeEventListener("click",xt),s.addEventListener("click",xt);const n=[...new Set(o.map(({fillColor:e})=>e)),""].filter(e=>e!==void 0).map(e=>`<div data-color="${e}" style="background-color: ${e};"></div>`);s.innerHTML=n.join("")}let N=null;const _=t=>{N=t},ct=k("debug")??!1,Wt="alexq",c=k()??160,W=c/2,at=k("taskNamePaddingLeft")??15,At=1,Ft=50,b=k("timeScaleHeight")??20,K=k("milestoneTopHeight")??20,f=k("barHeight")??30,w=ct?10:k("barMargin")??1,jt=k("scrollSpeed")??35,_t=k("includeHoliday")??!1,gt=k("useLocal"),Mt=k("useRemote"),st=k("view",!1)??"",Jt=!Mt&&!gt&&k("mockTaskSize")?Number(k("mockTaskSize")):0,Tt=Math.floor((+new Date-+new Date("2024-01-01"))/(60*60*24*1e3)),lt=(Tt-1)*c,mt=document.querySelector("#last-scroll-x");mt.innerText=lt;const Z=k("filter",!1)??null,Et=k("showFilter")??!1;function Yt(t,o,s,n){const e=document.querySelector("#back-to-origin-button");e==null||e.addEventListener("click",function(){t(lt),o(0),s.innerText=lt,n(!0)});const a=document.querySelector("#clear-button");a==null||a.addEventListener("click",function(){const u=tasks.length;tasks.length=0;for(let p=0;p<u;p++)tasks.push({});$(),n(!0)});const r=document.querySelector("#clear-milestone-button");r==null||r.addEventListener("click",function(){mileStones.length=0,$(),n(!0)}),Et&&bt(window.tasks)}function Gt(){return zrender.path.createFromString("M3.333,10v 5 c0,0.184 -0.149, 0.333 -0.333, 0.333 h-0.667A0.333, 0.333 0 0 1 2, 15 V 1.333 c0, -0.368 0.298, -0.666 0.667, -0.666 h 11.525 a 0.667, 0.667 0 0 1 0.581, 0.994 L 12.76, 5.233 a 0.333, 0.333 0 0 0 0.002, 0.33 L 14.753, 9 A 0.667, 0.667 0 0 1 14.176, 10 H 3.333z",{style:{fill:"#F54A45"}})}function Ut(t,o,s,n,e){const a=new zrender.Group,r=Gt(),{width:u,height:p}=r.getBoundingRect();r.attr({x:o+s-u/2,y:n-e+e/2-p/2});const i=new zrender.Circle({shape:{cx:o+s+1,cy:n-e+e/2,r:12},style:{fill:"rgba(211, 211, 211, 0.5)"}});return a.add(i),a.add(r),a.hide(),t.add(a),[a,{flag:r,flagHoveredCircle:i}]}function Vt(t,o,s,n){const{height:e,width:a}=s,r=new zrender.Rect({name:"leftBar",style:{fill:`rgba(0, 255, 0, ${ct?1:0})`,lineWidth:1},shape:{width:t,height:e},draggable:"horizontal",cursor:"ew-resize",z:1});r.attr({x:o.x,y:o.y,shape:{x:-t/2,y:0}});let u=0,p=0,i=0;return r.on("dragstart",function(l){this.parent.resizing=!0,u=l.event.zrX;const h=this.taskBar;i=h.shape.width,p=h.shape.x,_(this.parent)}),r.on("drag",function(l){const h=l.event.zrX-u;this.taskBar.attr({shape:{x:p+h,width:i-h}})}),r.on("dragend",function(l){const h=l.event.zrX-u,S=h<0?-1:1,H=Math.abs(h),A=H%c,P=S*(Math.floor(H/c)+Math.floor(A/W));console.log(P);const J=tasks[this.parent.index];J.start+=P,J.duration-=P,P&&$(),_(null),n(!0)}),r}function Kt(t,o,s,n){const{height:e,width:a}=s,r=new zrender.Rect({style:{fill:`rgba(255, 192, 203, ${ct?1:0})`,lineWidth:1},shape:{width:t,height:e},draggable:"horizontal",cursor:"ew-resize",z:1});r.attr({x:o.x+a,y:o.y,shape:{x:-t/2,y:0}});let u=0,p=0;return r.on("dragstart",function(i){this.parent.resizing=!0,u=i.event.zrX;const l=this.taskBar;p=l.shape.width,l.shape.x,console.log(N),_(this.parent)}),r.on("drag",function(i){const l=i.event.zrX-u;this.taskBar.attr({shape:{width:p+l}})}),r.on("dragend",function(i){const l=i.event.zrX-u,h=l<0?-1:1,S=Math.abs(l),H=S%c,A=h*(Math.floor(S/c)+Math.floor(H/W)),P=tasks[this.parent.index];P.duration+=A,A&&$(),_(null),n(!0)}),r}const Qt=+new Date("2024-01-01"),Zt=60*60*24*1e3;function te(t,o){const{start:s,duration:n}=t;if(o)return t.duration;let e=0;const a=n+s;for(let r=s;r<a;r++)vt(new Date(Qt+Zt*r)).isHoliday||e++;return e}function ee(t,o,s,n,e){return e<0||e>tasks.length-1?null:new zrender.Rect({shape:{x:t+s,y:o+(f+w)*e,width:n*c,height:1},style:{fill:"blue"},zlevel:1})}function ne(t,o,s,n,e,a,r){const u=new zrender.Rect({shape:{x:o+r*c-1+W,y:s,width:2,height:tasks.length*(e+a)},style:{fill:"#2955c9"},z:1}),p=new zrender.Circle({shape:{cx:o+r*c+W,cy:s-n+n+2,r:3},style:{fill:"#2955c9"}});t.add(u),t.add(p)}let ut=null,C=0+lt;const m=zrender.init(document.getElementById("zrender-container"),{renderer:"canvas"}),v=gt?Lt():[{name:"Task 1",start:0,duration:3,resource:"John",fillColor:j()},{name:"Task 2",start:2,duration:4,resource:"Jane",fillColor:j()},{name:"Task 3 long long long",start:7,duration:1,resource:"Bob",fillColor:j()},{name:"Task 4",start:8,duration:2,resource:"Bose",fillColor:j()},{name:"Task 5",start:10,duration:8,resource:"Uno",fillColor:j()},{}],oe=v.pop();for(;v.length>1&&v.length<Jt;)v.push(...v.map(t=>({...t})));v.push(oe);window.tasks=v;const Q=gt?Lt("mileStones"):[{start:10,name:"提测"}];window.mileStones=Q;m.on("mousewheel",function(t){t.event.preventDefault(),C-=Math.floor(t.event.wheelDeltaX*.01*jt),X(!0,C,0),mt.innerText=C});window.addEventListener("resize",function(){m.resize(),X(!0)});Yt(t=>C=t,t=>t,mt,X);function X(t,o=C,s=0){const n=At-o,e=Math.max(Ft,b+K)-s;t&&m.clear();const a=m.getWidth(),r=m.getHeight(),u=Math.floor(C/c),p=Math.floor((C+a)/c);let i,l;function h(d){if(N!=null&&N.resizing||N!=null&&N.dragging)return;const z=d.event.zrX-n,M=d.event.zrY-e,x=Math.floor(z/c),g=Math.floor(M/(f+w));if(i!==[x,g].join())if(i=[x,g].join(),g>=0&&g<v.length){if(x>=v[g].start&&x<v[g].start+v[g].duration){l&&m.remove(l);return}const y=new zrender.Group;y.on("click",function(){console.log("dayHoverGroup clicked pos: ",[x,g]);const O=prompt("task name?");if(!O)return;const q=prompt("assign to who?")||Wt;v.splice(g,0,{name:O,start:x,duration:1,resource:q,fillColor:j()}),$(),X(!0)});const T=new zrender.Rect({shape:{x:n+c*x+5,y:e+(f+w)*g,width:c-10,height:f+w},style:{fill:"transparent",stroke:"gray",lineDash:[5,7]},z:100}),E=new zrender.Rect({shape:{x:n+C,y:e+(f+w)*g,width:c*S,height:f+w},style:{fill:"rgba(221, 221, 221, 0.3)"},z:1}),I=new zrender.Line({shape:{x1:n+c*x+c/2-5,y1:e+(f+w)*g+(f+w)/2,x2:n+c*x+c/2+5,y2:e+(f+w)*g+(f+w)/2},style:{stroke:"gray"},z:100}),Y=new zrender.Line({shape:{x1:n+c*x+c/2,y1:e+(f+w)*g+(f+w)/2-5,x2:n+c*x+c/2,y2:e+(f+w)*g+(f+w)/2+5},style:{stroke:"gray"},z:100});y.add(T),y.add(I),y.add(Y),y.add(E),l&&m.remove(l),l=y,m.add(y)}else l&&m.remove(l)}ut&&m.off("mousemove",ut),ut=h,m.on("mousemove",h);const S=Math.ceil(a/c),H=new zrender.Rect({shape:{x:n+C,y:e-b,width:S*c,height:b},style:{fill:"rgba(255, 0,0, .2)"}});m.add(H);const A=n,P=S*c,J=S+1,Rt=Math.floor(C/c);for(let d=0+Rt,z=0;z<J;d++,z++){const M=Math.min(v.length,(r-e)/(f+w)),x=A+d*c,g=new zrender.Line({shape:{x1:x,y1:e-b,x2:x,y2:e+(f+w)*M},style:{stroke:"lightgray"}});if(z<J-1){const y=+new Date("2024-01-01")+d*60*1e3*60*24,T=vt(y);if(T.isHoliday)try{St([[n+d*c,e],[n+d*c+c,e],[n+d*c+c,e+(f+w)*M],[n+d*c,e+(f+w)*M]],10,45).forEach(D=>{const[et,nt]=D[0],[ot,G]=D[1],L=new zrender.Line({shape:{x1:et,y1:nt,x2:ot,y2:G},style:{stroke:"rgba(221, 221, 221, 0.7)"}});m.add(L)})}catch(R){console.log(R)}const E=new zrender.Text({style:{text:T.dateString,x,y:e-b},z:1}),[I,{flag:Y}]=Ut(m,x,W,e,b);E.on("click",function(){console.log("date text click",d);const R=Q.findIndex(D=>D.start===d);if(R===-1){if(confirm("Do you want to CREATE a milestone here?")){const D=prompt("mileStone name?");Q.push({start:d,name:D}),$()}}else confirm("Do you want to DELETE the milestone here?")&&(Q.splice(R,1),$());X(!0)}),E.on("mouseover",function(R){this.attr({style:{opacity:0}}),I.show()}),E.on("mouseout",function(R){this.attr({style:{opacity:1}}),I.hide()});const{width:O,height:q}=E.getBoundingRect();E.attr({style:{x:x-O/2+W,y:e-b-q/2+b/2}}),m.add(E)}m.add(g)}v.length+1;for(let d=0;d<1;d++){const z=e+d*(f+w),M=new zrender.Line({shape:{x1:n,y1:z,x2:P+n,y2:z},style:{stroke:"lightgray"}});m.add(M)}ne(m,n,e,b,f,w,Tt),Q.forEach(function(d){const z=new zrender.Rect({shape:{x:n+d.start*c-1,y:e-b,width:2,height:v.length*(f+w)+b},style:{fill:"rgba(255, 0, 0, 1)"},z:1}),M=new zrender.Rect({shape:{x:n+d.start*c-1,y:e-b-K,width:10,height:K},style:{fill:"rgba(255, 0, 0, 1)"},z:1}),x=new zrender.Text({style:{x:n+d.start*c-1+10,y:e-b-K,text:d.name||"里程碑",fill:"white",lineHeight:K,fontSize:12},z:1}),g=x.getBoundingRect();M.attr({shape:{width:g.width+10*2}}),m.add(z),m.add(M),m.add(x)});let yt=0;v.forEach(function(d,z){if(!(d!=null&&d.name)||z>Math.floor((r-e)/(f+w))||d.start>p||d.start+d.duration<u)return;yt++;const M=n+d.start*c,x=e+(f+w)*z,g=d.duration*c,tt={width:g,height:f},y=new zrender.Group({x:M,y:x,draggable:!0}),T=new zrender.Rect({shape:{x:0,y:0,width:g,height:f,r:6},style:{fill:d.fillColor},cursor:"move"});y.add(T),y.index=z;const E=6,I=T.getBoundingRect(),Y=Vt(E,I,tt,X);Y.taskBar=T,y.add(Y);const O=Kt(E,I,tt,X);O.taskBar=T,y.add(O),y.on("mouseover",function(){this.dragging||T.attr("style",{fill:zrender.color.lift(d.fillColor,.3)})}),y.on("mouseout",function(){this.dragging||this.resizing||T.attr("style",{fill:d.fillColor})});const q=new zrender.Text({style:{text:d.name,x:at,y:f/2-12/2,textFill:"white",textAlign:"left",textVerticalAlign:"middle",fill:"white"},cursor:"move"}),R=new zrender.Text({style:{text:`${te(d,_t)}天`,x:g-at,y:f/2-12/2,textFill:"white",textAlign:"left",textVerticalAlign:"middle",fill:"white"},cursor:"move"}),{width:D}=R.getBoundingRect();R.attr({style:{x:g-D-at}});const et=new zrender.Text({style:{text:"Assigned to: "+d.resource,x:0+g+5,y:f/2+0-12/2,textFill:"black"},cursor:"normal"});q.getBoundingRect().width+D+at*2>g&&(et.attr({style:{text:d.name}}),q.hide()),y.add(q),y.add(R),y.add(et);let nt=0,ot=null,G=null;y.on("dragstart",function(L){this.resizing||(nt=L.event.zrX,_(this))}),y.on("drag",function(L){if(this.resizing)return;const rt=L.event.zrY-e,U=Math.floor(rt/(f+w));if(ot!==U){ot=U,m.remove(G);const F=ee(n,e,C,S,U);G=F,F&&m.add(F),m.refresh()}}),y.on("dragend",function(L){if(console.log("dragend"),this.resizing){this.resizing=!1;return}const rt=L.event.zrX-nt,U=rt<0?-1:1,F=Math.abs(rt),Bt=F%c,wt=U*(Math.floor(F/c)+Math.floor(Bt/W)),Ct=L.event.zrY-e,V=Math.floor(Ct/(f+w)),Xt=V-z;d.start+=wt,G&&V!==z&&(v.splice(z,1),v.splice(V>z?V-1:V,0,{...d})),(wt||Xt)&&$(),_(null),X(!0)}),y.eachChild(function(L){L.attr({z:10})}),y.on("dblclick",function(){B.show();const L=document.querySelector("#current-task");L.value=JSON.stringify(v[this.index],null,2),L.dataset.index=this.index}),m.add(y)}),ct&&console.log({drawTaskBar:yt})}window.redrawChart=X;Mt?(document.title+=" (Remote)",It(m,X)):(Z&&ft("tasks",v.filter(t=>t.fillColor===Z)),X());
